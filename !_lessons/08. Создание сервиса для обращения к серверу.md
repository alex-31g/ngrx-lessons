## 08. Создание сервиса для обращения к серверу

После того, как пользователь заполнил форму, необходимо выполнить запрос к серверу, который отдаст нам список пользователей.    
Чтобы выполнить данный запрос, необходимо создать сервис auth.service.    
Ниже показано, какие файлы необходимо модифицировать или создать для этой задачи.

- Создаем сервис для работы с сервером `src\app\auth\auth.service.ts`:
```js
import { Injectable } from "@angular/core";
import { HttpClient } from "@angular/common/http";
import { Observable } from "rxjs";
import { Users } from "./model/users.model";
import { map } from 'rxjs/operators';

@Injectable()
export class AuthService {
	constructor(private http: HttpClient) {}

	getData(email: string, password: string): Observable<Users[]> {
		// В данном примере параметры email и password не используются

		return this.http.get<Users[]>('https://jsonplaceholder.typicode.com/users')

			// Избавляемся от ненужных полей и приводим полученные объекты в соответствие с моделью Users
			.pipe(
				map(data => {
					return data.map((user: any) => {
						return {id: user.id, name: user.username};
					});
			}))

	}
}
```

- Создаем модель Users `src\app\auth\model\users.model.ts`
```js
export interface Users {
	id: string;
	name: string;
}
```

- Добавляем в `src\app\auth\components\login\login.component.ts` обращение к сервису auth.service:
```js
import { AuthService } from "../../auth.service";
import { Users } from "../../model/users.model";

export class LoginComponent {
	users: Users[] = [];

	constructor(	
		private auth: AuthService,	
	) {}

	login() {
		const val = this.form.value;

		// email и password, которые ввел пользователь, должны отправляться на сервер.
		// Сервер должен проверять их и отдавать необходимые нам данные.
		// Но в нашем примере эта проверка будет сэмулирована внутри данного метода и,
		// если она успешна, мы выполним обращение к сервису, который запросит у сервера данные,
		// без использования email и password

		if (val.email !== 'test@test.com' || val.password !== 'test') {
			console.log('Wrong user data');
			return;
		}

		this.auth.getData(val.email, val.password)
			.subscribe((users) => {
				this.users = users;
			});
	}
```

- Добавляем в `src\app\app.module.ts`:
```js
import { HttpClientModule } from '@angular/common/http';
@NgModule({
  imports: [
		HttpClientModule,
		AuthModule.forRoot(),
  ],
})
```

- Добавляем в `src\app\auth\auth.module.ts`:
```js
import { ModuleWithProviders } from '@angular/core';
import { AuthService } from "./auth.service";
export class AuthModule {
	static forRoot(): ModuleWithProviders<AuthModule> {
		return {
			ngModule: AuthModule,
			providers: [
				AuthService
			]
		}
	}
}
```